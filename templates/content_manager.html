<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Content Manager - Language Arts Agent</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="bi bi-book-half text-primary"></i>
                Language Arts Agent - Content Manager
            </a>
            <div class="navbar-nav ms-auto">
                <a href="/" class="btn btn-outline-primary btn-sm">
                    <i class="bi bi-house"></i> Back to Home
                </a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <!-- Add New Material Form -->
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="bi bi-plus-circle"></i> Add New Reading Material</h5>
                    </div>
                    <div class="card-body">
                        <form id="addMaterialForm">
                            <div class="row mb-3">
                                <div class="col-md-8">
                                    <label for="title" class="form-label">Title *</label>
                                    <input type="text" class="form-control" id="title" required>
                                </div>
                                <div class="col-md-4">
                                    <label for="difficulty" class="form-label">Difficulty *</label>
                                    <select class="form-select" id="difficulty" required>
                                        <option value="">Select Difficulty</option>
                                        <option value="beginner">Beginner</option>
                                        <option value="intermediate">Intermediate</option>
                                        <option value="advanced">Advanced</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="category" class="form-label">Category *</label>
                                    <select class="form-select" id="category" required>
                                        <option value="">Select Category</option>
                                        <option value="academic">Academic</option>
                                        <option value="news">News</option>
                                        <option value="literature">Literature</option>
                                        <option value="toefl">TOEFL Prep</option>
                                        <option value="ielts">IELTS Prep</option>
                                        <option value="business">Business English</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="tags" class="form-label">Tags (comma-separated)</label>
                                    <input type="text" class="form-control" id="tags" placeholder="technology, education, science">
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="targetExams" class="form-label">Target Exams</label>
                                <div class="form-check-container">
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="checkbox" id="toefl" value="TOEFL">
                                        <label class="form-check-label" for="toefl">TOEFL</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="checkbox" id="ielts" value="IELTS">
                                        <label class="form-check-label" for="ielts">IELTS</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="checkbox" id="gre" value="GRE">
                                        <label class="form-check-label" for="gre">GRE</label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="content" class="form-label">Article Content *</label>
                                <textarea class="form-control" id="content" rows="15" required 
                                          placeholder="Paste or type your article content here..."></textarea>
                                <div class="form-text">
                                    <span id="wordCount">0</span> words | Estimated reading time: <span id="readingTime">0</span> minutes
                                </div>
                            </div>
                            
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-plus-circle"></i> Add Reading Material
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Current Materials List -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h6><i class="bi bi-list"></i> Current Materials</h6>
                    </div>
                    <div class="card-body">
                        <div id="materialsList">
                            <div class="text-center">
                                <div class="spinner-border spinner-border-sm" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Guidelines -->
                <div class="card mt-3">
                    <div class="card-header">
                        <h6><i class="bi bi-info-circle"></i> Content Guidelines</h6>
                    </div>
                    <div class="card-body">
                        <ul class="small mb-0">
                            <li><strong>Word Count:</strong> 300+ words recommended</li>
                            <li><strong>Copyright:</strong> Use only free/public domain content</li>
                            <li><strong>Quality:</strong> Educational and engaging</li>
                            <li><strong>Audience:</strong> Chinese students (ages 16-20)</li>
                            <li><strong>Topics:</strong> Academic, current events, literature</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Free Content Sources -->
                <div class="card mt-3">
                    <div class="card-header">
                        <h6><i class="bi bi-globe"></i> Free Content Sources</h6>
                    </div>
                    <div class="card-body">
                        <ul class="small mb-0">
                            <li><a href="https://www.wikipedia.org" target="_blank">Wikipedia</a></li>
                            <li><a href="https://www.gutenberg.org" target="_blank">Project Gutenberg</a></li>
                            <li><a href="https://www.nasa.gov/news" target="_blank">NASA News</a></li>
                            <li><a href="https://www.un.org/news" target="_blank">UN News</a></li>
                            <li><strong>Custom:</strong> Write your own!</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        class ContentManager {
            constructor() {
                this.init();
            }
            
            init() {
                this.bindEvents();
                this.loadMaterialsList();
            }
            
            bindEvents() {
                // Word count tracking
                document.getElementById('content').addEventListener('input', () => {
                    this.updateWordCount();
                });
                
                // Form submission
                document.getElementById('addMaterialForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitMaterial();
                });
            }
            
            updateWordCount() {
                const content = document.getElementById('content').value;
                const wordCount = content.trim().split(/\s+/).filter(word => word.length > 0).length;
                const readingTime = Math.max(1, Math.round(wordCount / 200));
                
                document.getElementById('wordCount').textContent = wordCount;
                document.getElementById('readingTime').textContent = readingTime;
            }
            
            async submitMaterial() {
                const formData = this.collectFormData();
                
                if (!this.validateForm(formData)) {
                    return;
                }
                
                try {
                    // This would need an API endpoint to handle material creation
                    const response = await fetch('/api/admin/reading-materials', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(formData)
                    });
                    
                    if (response.ok) {
                        alert('Material added successfully!');
                        this.resetForm();
                        this.loadMaterialsList();
                    } else {
                        alert('Error adding material. Please try again.');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Network error. Please check your connection.');
                }
            }
            
            collectFormData() {
                const targetExams = [];
                if (document.getElementById('toefl').checked) targetExams.push('TOEFL');
                if (document.getElementById('ielts').checked) targetExams.push('IELTS');
                if (document.getElementById('gre').checked) targetExams.push('GRE');
                
                const tags = document.getElementById('tags').value
                    .split(',')
                    .map(tag => tag.trim())
                    .filter(tag => tag.length > 0);
                
                const content = document.getElementById('content').value;
                const wordCount = content.trim().split(/\s+/).filter(word => word.length > 0).length;
                
                return {
                    title: document.getElementById('title').value,
                    content: content,
                    difficulty_level: document.getElementById('difficulty').value,
                    category: document.getElementById('category').value,
                    tags: tags,
                    target_exams: targetExams,
                    word_count: wordCount,
                    estimated_reading_time: Math.max(1, Math.round(wordCount / 200))
                };
            }
            
            validateForm(data) {
                if (!data.title || !data.content || !data.difficulty_level || !data.category) {
                    alert('Please fill in all required fields.');
                    return false;
                }
                
                if (data.word_count < 100) {
                    alert('Content should be at least 100 words long.');
                    return false;
                }
                
                return true;
            }
            
            resetForm() {
                document.getElementById('addMaterialForm').reset();
                this.updateWordCount();
            }
            
            async loadMaterialsList() {
                // This would load existing materials from API
                document.getElementById('materialsList').innerHTML = `
                    <div class="small">
                        <p><strong>Current materials:</strong></p>
                        <p class="text-muted">Load this data from your API...</p>
                    </div>
                `;
            }
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new ContentManager();
        });
    </script>
</body>
</html>